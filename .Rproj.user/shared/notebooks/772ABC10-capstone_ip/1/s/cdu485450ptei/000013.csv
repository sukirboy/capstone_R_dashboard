"0",""
"0","# Compute percentages"
"0","groupby_payment$fraction = groupby_payment$count_qty / sum(groupby_payment$count_qty)"
"0",""
"0","# Compute the cumulative percentages (top of each rectangle)"
"0","groupby_payment$ymax = cumsum(groupby_payment$fraction)"
"0",""
"0","# Compute the bottom of each rectangle"
"0","groupby_payment$ymin = c(0, head(groupby_payment$ymax, n=-1))"
"0",""
"0","plot_groupby_payment <- ggplot(groupby_payment, aes(ymax=ymax, ymin=ymin, xmax=4, xmin=3, fill=Payment)) +"
"0","     geom_rect() +"
"0","     coord_polar(theta=""y"") + # Try to remove that to understand how the chart is built initially"
"0","     xlim(c(2, 4))+"
"0","     theme_void() +"
"0","     theme(legend.position = ""none"")"
"0",""
"0","plot_groupby_payment"
